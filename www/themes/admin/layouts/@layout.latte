{**
 * Venne:CMS layout template.
 *
 * @copyright  Copyright (c) 2011 Josef Kříž 
 *
 * @param string   $basePath	web base path
 * @param array    $flashes		flash messages
 *}

{extends "./../../@html5.latte"}

{block #body}

{js /themes/admin/js/admin.js}
{css /themes/admin/css/style.css}

	<div id="page">
		<div id="top">
			{if !$venneModeInstallation}<a href="{link :Core:Admin:Default:}">{/if}
				<div id="logo"></div>
			{if !$venneModeInstallation}</a>{/if}
			<div id="menu">
				{if !isset($hideMenuItems) && $presenter->context->doctrineContainer->checkConnection() && !$presenter->context->moduleManager->checkModuleUpgrades()}
				<ul>
					<li><a class="{if $presenter->isLinkCurrent(":Website:Admin:*")}active{/if}" href="{plink :Website:Admin:Default:}">Správa webu</a></li>
					<li><a class="{if $presenter->isLinkCurrent(":Modules:Admin:*")}active{/if}" href="{plink :Modules:Admin:Default:}">Správa modulů</a></li>
					<li><a class="{if $presenter->isLinkCurrent(":Security:Admin:*")}active{/if}" href="{plink :Security:Admin:Default:}">Security settings</a></li>
					<li><a class="{if $presenter->isLinkCurrent(":System:Admin:*")}active{/if}" href="{plink :System:Admin:Default:}">Správa systému</a></li>
				</ul>
				{/if}
			</div>
		</div>
		<div id="middle">
			<div id="middle-left">
				<div id="submenu">
					{if !isset($hideMenuItems) && $presenter->context->doctrineContainer->checkConnection() && !$presenter->context->moduleManager->checkModuleUpgrades()}
						<h3>{_"Modules settings"}</h3>
						<ul>
						{foreach $adminMenu as $item}
							{dump $item->mask}
							<li class="{if $presenter->isLinkCurrent($item->mask)}active{/if}"><a href="{$presenter->link($item->link)}">{$item->name}</a>
								{if count($item->childrens) > 0}
								<ul>
								{foreach $item->childrens as $item2}
									<li class="{if $presenter->isLinkCurrent($item2->mask)}active{/if}"><a href="{$presenter->link($item2->link)}">{$item2->name}</a></li>
								{/foreach}
								</ul>
								{/if}
							</li>
						{/foreach}
						<ul>
					{/if}
				</div>
			</div>
			<div id="content" class="module-">
				{if $presenter->context->hasService("navigationModule")}
				{if !isset($hideMenuItems)}{control navigation:path}{/if}
				{/if}
				{foreach $flashes as $flash}<div class="flash {$flash->type}">{$flash->message}</div>{/foreach}
				{include #content}
			</div>
		</div>
		<div id="bottom">
			<span>Copyright © 2011 Josef Kříž</span> | <span>version {$venneVersionId} {$venneVersionState}</span>{if !$venneModeInstallation} | <span><a href="{link :Core:Admin:About:}">about Venne:CMS</a></span>{/if}
		</div>
	</div>
{/block}
